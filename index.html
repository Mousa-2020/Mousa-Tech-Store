<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mousa Tech Store | Ù…ØªØ¬Ø± Ù…ÙˆØ³Ù‰ Ù„Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <img src="logo.png" alt="Mousa Tech Store" class="logo">
            <div class="header-buttons">
                <button class="icon-btn" onclick="window.location.href='cart.html'">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count" id="cartCount">0</span>
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="search-box">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." class="search-input">
            <div id="searchResults" class="search-results"></div>
        </div>
    </div>

    <div class="container">
        <div class="categories">
            <button class="category-btn active" onclick="filterProducts('all')">Ø§Ù„ÙƒÙ„</button>
            <button class="category-btn" onclick="filterProducts('apple')">ğŸ“± Ø£Ø¨Ù„</button>
            <button class="category-btn" onclick="filterProducts('samsung')">ğŸ“± Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬</button>
            <button class="category-btn" onclick="filterProducts('gaming')">ğŸ® Ø£Ù„Ø¹Ø§Ø¨</button>
            <button class="category-btn" onclick="filterProducts('accessories')">ğŸ§ Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª</button>
            <button class="category-btn" onclick="filterProducts('health')">ğŸ¥ ØµØ­Ø©</button>
            <button class="category-btn" onclick="filterProducts('tech')">ğŸš€ ØªÙ‚Ù†ÙŠØ§Øª</button>
        </div>
    </div>

    <section class="container">
        <h2 class="section-title">ğŸ”¥ Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹</h2>
        <div class="products-grid" id="productsGrid"></div>
    </section>

    <section class="container">
        <h2 class="section-title">âœ¨ Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù…ØªØ¬Ø±</h2>
        <div class="products-grid" id="newProductsGrid"></div>
    </section>

    <a href="https://wa.me/9647717538315" class="whatsapp-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script src="products.js"></script>
    <script>
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let allProducts = [];

        function loadProducts() {
            const saved = localStorage.getItem('products');
            if (saved) {
                allProducts = JSON.parse(saved);
            } else {
                allProducts = [];
                for (let cat in productsData) {
                    allProducts = allProducts.concat(productsData[cat]);
                }
            }
            displayProducts(allProducts.slice(0, 8), 'productsGrid');
            displayProducts(allProducts.slice(8, 16), 'newProductsGrid');
            updateCartCount();
        }

        function displayProducts(products, gridId) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = products.map(p => `
                <div class="product-card">
                    <div class="product-image" onclick="viewProduct(${p.id})">
                        <img src="${p.image}" alt="${p.name}">
                    </div>
                    <div class="product-info">
                        <div class="product-name" onclick="viewProduct(${p.id})">${p.name}</div>
                        <div class="product-price">$${Number(p.price).toLocaleString()}</div>
                        <button class="add-to-cart" onclick="addToCart(${p.id})">
                            <i class="fas fa-cart-plus"></i> Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addToCart(id) {
            const product = allProducts.find(p => p.id === id);
            if (product) {
                cart.push(product);
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                alert('âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©');
            }
        }

        function updateCartCount() {
            document.getElementById('cartCount').textContent = cart.length;
        }

        function filterProducts(cat) {
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            if (cat === 'all') {
                displayProducts(allProducts.slice(0, 8), 'productsGrid');
                displayProducts(allProducts.slice(8, 16), 'newProductsGrid');
            } else {
                const filtered = allProducts.filter(p => p.category === cat);
                displayProducts(filtered.slice(0, 8), 'productsGrid');
                document.getElementById('newProductsGrid').innerHTML = '';
            }
        }

        function viewProduct(id) {
            window.location.href = `product.html?id=${id}`;
        }

        // Ø§Ù„Ø¨Ø­Ø«
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const term = e.target.value.toLowerCase();
            if (term.length < 2) return;
            
            const results = allProducts.filter(p => 
                p.name.toLowerCase().includes(term)
            ).slice(0, 5);
            
            const resultsDiv = document.getElementById('searchResults');
            if (results.length > 0) {
                resultsDiv.innerHTML = results.map(p => `
                    <div class="search-result-item" onclick="viewProduct(${p.id})">
                        <img src="${p.image}" style="width:40px; height:40px; object-fit:contain;">
                        <span>${p.name} - $${p.price}</span>
                    </div>
                `).join('');
                resultsDiv.style.display = 'block';
            } else {
                resultsDiv.style.display = 'none';
            }
        });

        loadProducts();
    </script>
</body>
</html>
