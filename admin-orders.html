<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø·Ù„Ø¨Ø§Øª - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Mousa Tech Store</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background: #f1f5f9;
        }

        /* Ù„Ù„Ø¬ÙˆØ§Ù„ */
        .mobile-top-bar {
            display: none;
            background: #0A0F1F;
            color: white;
            padding: 15px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            justify-content: space-between;
        }

        .mobile-top-bar h2 {
            color: #F97316;
        }

        .mobile-bottom-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #0A0F1F;
            padding: 8px;
            z-index: 1000;
            justify-content: space-around;
        }

        .mobile-nav-item {
            color: #94a3b8;
            text-align: center;
            font-size: 0.7rem;
        }

        .mobile-nav-item i {
            font-size: 1.2rem;
            display: block;
        }

        .mobile-nav-item.active {
            color: #F97316;
        }

        /* Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± */
        .sidebar {
            width: 250px;
            background: #0A0F1F;
            color: white;
            height: 100vh;
            position: fixed;
            right: 0;
            top: 0;
            padding: 20px 0;
        }

        .logo-area {
            padding: 0 20px 20px;
            border-bottom: 1px solid #334155;
        }

        .logo-area h2 {
            color: #F97316;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #cbd5e1;
            cursor: pointer;
        }

        .menu-item:hover {
            background: #1e293b;
        }

        .menu-item.active {
            background: #F97316;
            color: white;
        }

        .main-content {
            margin-right: 250px;
            padding: 20px;
        }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
        .filters-bar {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            display: flex;
            align-items: center;
            background: #f1f5f9;
            border-radius: 8px;
            padding: 0 15px;
            min-width: 200px;
        }

        .search-box input {
            border: none;
            background: none;
            padding: 12px;
            width: 100%;
            outline: none;
        }

        .filter-select {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            min-width: 150px;
        }

        .export-btn {
            background: #F97316;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
        }

        .orders-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }

        .order-card {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .order-id {
            font-weight: 700;
            color: #F97316;
        }

        .order-body {
            display: none;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .order-body.show {
            display: grid;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            display: inline-block;
        }

        .status-new {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-shipped {
            background: #fef3c7;
            color: #92400e;
        }

        .status-delivered {
            background: #d1fae5;
            color: #065f46;
        }

        .action-btn {
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            margin: 0 5px;
        }

        .action-btn:hover {
            color: #F97316;
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .mobile-top-bar {
                display: flex;
            }

            .mobile-bottom-nav {
                display: flex;
            }

            .main-content {
                margin-right: 0;
                padding: 70px 10px 80px 10px;
            }

            .filters-bar {
                flex-direction: column;
            }

            .order-body {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="mobile-top-bar">
        <h2>Mousa Tech</h2>
        <div><i class="fas fa-bell"></i> <i class="fas fa-user"></i></div>
    </div>

    <div class="sidebar">
        <div class="logo-area">
            <h2>Mousa Tech</h2>
            <small>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</small>
        </div>
        <div class="menu-item" onclick="window.location.href='admin-dashboard.html'">ğŸ“Š Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
        <div class="menu-item" onclick="window.location.href='admin-products.html'">ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
        <div class="menu-item active">ğŸ“‹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
        <div class="menu-item" onclick="window.location.href='admin-customers.html'">ğŸ‘¥ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
        <div class="menu-item" onclick="window.location.href='admin-reports.html'">ğŸ“ˆ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
    </div>

    <div class="mobile-bottom-nav">
        <div class="mobile-nav-item" onclick="window.location.href='admin-dashboard.html'">ğŸ“Š</div>
        <div class="mobile-nav-item" onclick="window.location.href='admin-products.html'">ğŸ“¦</div>
        <div class="mobile-nav-item active">ğŸ“‹</div>
        <div class="mobile-nav-item" onclick="window.location.href='admin-customers.html'">ğŸ‘¥</div>
        <div class="mobile-nav-item" onclick="window.location.href='admin-reports.html'">ğŸ“ˆ</div>
    </div>

    <div class="main-content">
        <div class="filters-bar">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø«..." onkeyup="filterOrders()">
            </div>
            <select class="filter-select" id="statusFilter" onchange="filterOrders()">
                <option value="all">Ø§Ù„ÙƒÙ„</option>
                <option value="Ø¬Ø¯ÙŠØ¯">Ø¬Ø¯ÙŠØ¯</option>
                <option value="Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„">Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                <option value="ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
            </select>
            <button class="export-btn" onclick="exportOrders()">
                <i class="fas fa-file-excel"></i> ØªØµØ¯ÙŠØ±
            </button>
        </div>

        <div class="orders-container" id="ordersContainer"></div>
    </div>

    <script>
        // ===== Ø¬Ù„Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù† localStorage =====
        let orders = JSON.parse(localStorage.getItem('orders')) || [];
        
        // Ø¥Ø°Ø§ Ù…Ø§ÙÙŠ Ø·Ù„Ø¨Ø§ØªØŒ Ù†Ø¶ÙŠÙ Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ
        if (orders.length === 0) {
            orders.push({
                id: Date.now(),
                date: new Date().toLocaleString('ar-IQ'),
                customer: {
                    name: 'Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ',
                    phone: '07712345678',
                    gov: 'Ø¨ØºØ¯Ø§Ø¯',
                    address: 'Ø§Ù„ÙƒØ±Ø§Ø¯Ø©'
                },
                items: [{ name: 'iPhone 15 Pro', price: 1233 }],
                total: 1233,
                payment: 'Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…',
                status: 'Ø¬Ø¯ÙŠØ¯'
            });
            localStorage.setItem('orders', JSON.stringify(orders));
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        function displayOrders(ordersToShow = orders) {
            const container = document.getElementById('ordersContainer');
            
            if (ordersToShow.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</div>';
                return;
            }

            container.innerHTML = ordersToShow.map(order => {
                const statusClass = {
                    'Ø¬Ø¯ÙŠØ¯': 'status-new',
                    'Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„': 'status-shipped',
                    'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„': 'status-delivered'
                }[order.status] || 'status-new';

                return `
                    <div class="order-card">
                        <div class="order-header" onclick="toggleDetails(${order.id})">
                            <div>
                                <span class="order-id">#${order.id}</span>
                                <span style="margin-right: 10px;">${order.date}</span>
                            </div>
                            <span class="status-badge ${statusClass}">${order.status}</span>
                        </div>
                        <div class="order-body" id="details-${order.id}">
                            <div>
                                <strong>ğŸ‘¤ ${order.customer.name}</strong><br>
                                ğŸ“ ${order.customer.phone}<br>
                                ğŸ“ ${order.customer.gov} - ${order.customer.address}
                            </div>
                            <div>
                                <strong>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</strong><br>
                                ${order.items.map(i => `â€¢ ${i.name} - $${i.price}`).join('<br>')}
                            </div>
                            <div>
                                <strong>ğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: $${order.total}</strong><br>
                                ğŸ’³ ${order.payment}<br>
                                <button class="action-btn" onclick="printOrder(${order.id})"><i class="fas fa-print"></i></button>
                                <button class="action-btn" onclick="changeStatus(${order.id})"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªÙØ§ØµÙŠÙ„
        function toggleDetails(id) {
            document.getElementById(`details-${id}`).classList.toggle('show');
        }

        // ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©
        function changeStatus(id) {
            const newStatus = prompt('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø­Ø§Ù„Ø© (Ø¬Ø¯ÙŠØ¯ - Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„ - ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„)');
            if (newStatus && ['Ø¬Ø¯ÙŠØ¯', 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„', 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„'].includes(newStatus)) {
                const order = orders.find(o => o.id === id);
                if (order) {
                    order.status = newStatus;
                    localStorage.setItem('orders', JSON.stringify(orders));
                    displayOrders();
                }
            }
        }

        // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        function filterOrders() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const status = document.getElementById('statusFilter').value;

            let filtered = orders;

            if (search) {
                filtered = filtered.filter(o => 
                    o.customer.name.toLowerCase().includes(search) ||
                    o.customer.phone.includes(search) ||
                    o.id.toString().includes(search)
                );
            }

            if (status !== 'all') {
                filtered = filtered.filter(o => o.status === status);
            }

            displayOrders(filtered);
        }

        // Ø·Ø¨Ø§Ø¹Ø©
        function printOrder(id) {
            const order = orders.find(o => o.id === id);
            alert(`Ø·Ø¨Ø§Ø¹Ø© ÙØ§ØªÙˆØ±Ø© #${order.id}`);
        }

        // ØªØµØ¯ÙŠØ± Excel
        function exportOrders() {
            let csv = 'Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ù„Ø¹Ù…ÙŠÙ„,Ø§Ù„Ù‡Ø§ØªÙ,Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©,Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª,Ø§Ù„Ù…Ø¨Ù„Øº,Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹,Ø§Ù„Ø­Ø§Ù„Ø©\n';
            
            orders.forEach(o => {
                const products = o.items.map(i => i.name).join(' - ');
                csv += `"${o.id}","${o.date}","${o.customer.name}","${o.customer.phone}","${o.customer.gov}","${products}",${o.total},"${o.payment}","${o.status}"\n`;
            });

            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª.csv';
            a.click();
            URL.revokeObjectURL(url);
        }

        displayOrders();
    </script>
</body>
</html>
