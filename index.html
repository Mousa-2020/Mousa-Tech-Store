<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mousa Tech Store | Ù…ØªØ¬Ø± Ù…ÙˆØ³Ù‰ Ù„Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico">
</head>
<body>
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
    <header class="header">
        <div class="container">
            <img src="logo.png" alt="Mousa Tech Store" class="logo">
            <div class="header-buttons">
                <button class="icon-btn" onclick="window.location.href='cart.html'">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </button>
                <button class="icon-btn" onclick="window.location.href='profile.html'">
                    <i class="fas fa-user"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ -->
    <div class="container search-container">
        <div class="search-box">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." class="search-input" autocomplete="off">
            <div id="suggestions" class="suggestions-box"></div>
        </div>
    </div>

    <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ÙØ¦Ø§Øª -->
    <div class="container">
        <div class="categories">
            <button class="category-btn active" onclick="filterProducts('all', this)">Ø§Ù„ÙƒÙ„</button>
            <button class="category-btn" onclick="filterProducts('apple', this)">ğŸ“± Ø£Ø¨Ù„</button>
            <button class="category-btn" onclick="filterProducts('samsung', this)">ğŸ“± Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬</button>
            <button class="category-btn" onclick="filterProducts('gaming', this)">ğŸ® Ø£Ù„Ø¹Ø§Ø¨</button>
            <button class="category-btn" onclick="filterProducts('accessories', this)">ğŸ§ Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª</button>
            <button class="category-btn" onclick="filterProducts('health', this)">ğŸ¥ ØµØ­Ø©</button>
            <button class="category-btn" onclick="filterProducts('tech', this)">ğŸš€ ØªÙ‚Ù†ÙŠØ§Øª</button>
        </div>
    </div>

    <!-- Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙŠÙˆÙ… -->
    <div class="container">
        <div class="offer-banner" id="offerBanner">
            <!-- ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙŠÙˆÙ… -->
        </div>
    </div>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ø£ÙƒØ«Ø± ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹ -->
    <section class="container">
        <h2 class="section-title">â­ Ø§Ù„Ø£ÙƒØ«Ø± ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹</h2>
        <div class="products-grid" id="topRatedGrid"></div>
    </section>

    <!-- Ù‚Ø³Ù… Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
    <section class="container">
        <h2 class="section-title">ğŸ†• Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
        <div class="products-grid" id="newProductsGrid"></div>
    </section>

    <!-- Ø²Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø«Ø§Ø¨Øª -->
    <a href="https://wa.me/9647717538315" class="whatsapp-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script src="products.js"></script>
    <script>
        // ===== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© =====
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let allProducts = [];
        let currentFilter = 'all';

        // ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª =====
        function loadProducts() {
            const savedProducts = localStorage.getItem('products');
            
            if (savedProducts) {
                allProducts = JSON.parse(savedProducts);
                console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„', allProducts.length, 'Ù…Ù†ØªØ¬ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…');
            } else {
                allProducts = [];
                for (const category in productsData) {
                    allProducts = allProducts.concat(productsData[category]);
                }
                console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„', allProducts.length, 'Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø«Ø§Ø¨Øª');
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø®Ø§ØµÙŠØ© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
            allProducts = allProducts.map(p => ({
                ...p,
                rating: p.rating || Math.floor(Math.random() * 5) + 1,
                reviews: p.reviews || []
            }));
            
            displayOffer();
            displayTopRated();
            displayNewProducts();
            updateCartCount();
        }

        // ===== Ø¹Ø±Ø¶ Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙŠÙˆÙ… =====
        function displayOffer() {
            if (allProducts.length === 0) return;
            
            // Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†ØªØ¬ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„Ù„Ø¹Ø±Ø¶
            const offerProduct = allProducts[Math.floor(Math.random() * allProducts.length)];
            const offerPrice = offerProduct.price;
            const originalPrice = Math.round(offerPrice * 1.2); // 20% Ø²ÙŠØ§Ø¯Ø© Ù„Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ
            
            document.getElementById('offerBanner').innerHTML = `
                <div class="offer-title">ğŸ”¥ Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…</div>
                <div class="offer-subtitle">${offerProduct.name}</div>
                <div class="offer-price">$${offerPrice} <span class="offer-old-price">$${originalPrice}</span></div>
                <div class="offer-stock">âš ï¸ ÙÙ‚Ø· 5 Ù‚Ø·Ø¹ Ù…ØªØ¨Ù‚ÙŠØ©</div>
            `;
        }

        // ===== Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø´Ø¨ÙƒØ© =====
        function displayProducts(products, elementId) {
            const grid = document.getElementById(elementId);
            if (!grid) return;

            if (products.length === 0) {
                grid.innerHTML = '<p style="text-align: center; padding: 40px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</p>';
                return;
            }

            grid.innerHTML = products.map(product => {
                const rating = product.rating || 5;
                const stars = 'â˜…'.repeat(rating) + 'â˜†'.repeat(5-rating);
                
                return `
                <div class="product-card">
                    ${product.stock && product.stock < 5 ? '<div class="product-badge">âš ï¸ Ù…Ø®Ø²ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯</div>' : ''}
                    <div class="product-image" onclick="window.location.href='product.html?id=${product.id}'">
                        <img src="${product.image}" alt="${product.name}">
                    </div>
                    <div class="product-info">
                        <div class="product-name" onclick="window.location.href='product.html?id=${product.id}'">${product.name}</div>
                        <div class="product-rating">
                            <span class="stars">${stars}</span>
                            <span>(${product.reviews?.length || 0})</span>
                        </div>
                        <div class="product-price">$${product.price}</div>
                        <button class="add-to-cart" onclick="addToCart(${product.id})">
                            <i class="fas fa-shopping-cart"></i> Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©
                        </button>
                    </div>
                </div>
            `}).join('');
        }

        // ===== Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙƒØ«Ø± ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹ =====
        function displayTopRated() {
            const topRated = [...allProducts]
                .sort((a, b) => (b.rating || 0) - (a.rating || 0))
                .slice(0, 8);
            displayProducts(topRated, 'topRatedGrid');
        }

        // ===== Ø¹Ø±Ø¶ Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª =====
        function displayNewProducts() {
            const newProducts = allProducts.slice(0, 8);
            displayProducts(newProducts, 'newProductsGrid');
        }

        // ===== Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© =====
        function addToCart(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (product) {
                cart.push(product);
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                
                // Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø¨Ø«Ù‚Ø©
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: var(--success);
                    color: white;
                    padding: 15px 25px;
                    border-radius: 8px;
                    z-index: 9999;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    animation: slideDown 0.3s;
                `;
                notification.textContent = 'âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©';
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 2000);
            }
        }

        // ===== ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø³Ù„Ø© =====
        function updateCartCount() {
            document.querySelectorAll('.cart-count').forEach(el => {
                el.textContent = cart.length;
            });
        }

        // ===== ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø© =====
        function filterProducts(category, btn) {
            currentFilter = category;
            
            document.querySelectorAll('.category-btn').forEach(b => {
                b.classList.remove('active');
            });
            btn.classList.add('active');
            
            if (category === 'all') {
                displayNewProducts();
                displayTopRated();
            } else {
                const filtered = allProducts.filter(p => p.category === category);
                displayProducts(filtered, 'topRatedGrid');
                document.getElementById('newProductsGrid').innerHTML = '';
            }
        }

        // ===== Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ =====
        const searchInput = document.getElementById('searchInput');
        const suggestionsBox = document.getElementById('suggestions');

        searchInput.addEventListener('input', function() {
            const term = this.value.toLowerCase().trim();
            
            if (term.length < 2) {
                suggestionsBox.style.display = 'none';
                return;
            }

            const matches = allProducts.filter(p => 
                p.name.toLowerCase().includes(term) ||
                (p.altNames && p.altNames.some(n => n.toLowerCase().includes(term)))
            ).slice(0, 5);

            if (matches.length > 0) {
                suggestionsBox.innerHTML = matches.map(p => `
                    <div class="suggestion-item" onclick="window.location.href='product.html?id=${p.id}'">
                        <img src="${p.image}" alt="${p.name}">
                        <div class="suggestion-info">
                            <div class="suggestion-name">${p.name}</div>
                            <div class="suggestion-price">$${p.price}</div>
                        </div>
                    </div>
                `).join('');
                suggestionsBox.style.display = 'block';
            } else {
                suggestionsBox.style.display = 'none';
            }
        });

        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target)) {
                suggestionsBox.style.display = 'none';
            }
        });

        // ===== Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ =====
        loadProducts();
        </script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js"></script>
<script src="firebase-config.js"></script>
</body>
</html>
